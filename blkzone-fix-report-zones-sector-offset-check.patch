From 8a7f4b5bfe35ffc5f32cea67335d8265f77a4697 Mon Sep 17 00:00:00 2001
From: Masato Suzuki <masato.suzuki@wdc.com>
Date: Tue, 23 Oct 2018 18:31:35 +0900
Subject: [PATCH 447/686] blkzone: fix report zones sector offset check

To catch an offset error, an offset should be begger than or equal to
a device size in the condition.

Signed-off-by: Masato Suzuki <masato.suzuki@wdc.com>
---
 sys-utils/blkzone.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/sys-utils/blkzone.c b/sys-utils/blkzone.c
index b6a3aa4..1dcbdf5 100644
--- a/sys-utils/blkzone.c
+++ b/sys-utils/blkzone.c
@@ -179,8 +179,9 @@ static int blkzone_report(struct blkzone_control *ctl)
 
 	fd = init_device(ctl, O_RDONLY);
 
-	if (ctl->offset > ctl->total_sectors)
-		errx(EXIT_FAILURE, _("%s: offset is greater than device size"), ctl->devname);
+	if (ctl->offset >= ctl->total_sectors)
+		errx(EXIT_FAILURE,
+		     _("%s: offset is greater than or equal to device size"), ctl->devname);
 
 	zonesize = blkdev_chunk_sectors(ctl->devname);
 	if (!zonesize)
-- 
1.8.3.1

